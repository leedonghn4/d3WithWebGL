!function(){function e(i){this.keys_=e.prototype.PQKeyRenew_(!1,e.INIT_SIZE_),this.order_=!1,this.size_=0,this.max_=e.INIT_SIZE_,this.initialized_=!1,this.leq_=i,this.heap_=new t(this.leq_)}function t(e){this.ns_=i.renew(!1,t.INIT_SIZE_+1),this.handles_=r.renew(!1,t.INIT_SIZE_+1),this.size_=0,this.max_=t.INIT_SIZE_,this.fList_=0,this.initialized_=!1,this.leq_=e,this.ns_[1].handle=1}function i(){this.handle=0}function r(){this.key=!1,this.n=0}function n(){}function a(e){return e}function s(e){return[].push.call(this,e)}function o(e){return 0!=e&&!(e&e-1)}function c(e){return Math.pow(Math.ceil(Math.sqrt(e)),2)}function h(e,t){for(var i in e)t(e[i],i,e)}function u(){return[-1,-1,1,-1,-1,1,1,1]}function u(){return[-1,-1,1,-1,-1,1,-1,1,1,1,1,-1]}function l(e){return e.split(".").pop().join().match(/mp4|ogg|webm/)}function f(){return!(this.height!=this.width||!o(this.height)||!o(this.width)||(this.data||{}).constructor===HTMLVideoElement)}function p(e,t){if(arguments.length>2)[].forEach.call(arguments,function(t){p(e,t)});else for(var i in t)e[i]=t[i];return e}function d(e,t){!e||e.complete||4==e.readyState?t():e.addEventListener&&e.addEventListener("load",t)}function _(e,t){e||console.log(t)}function v(){_(0,"not yet implemented")}function m(e){var t=L(e);return+(255*t[0])<<16^255*t[1]<<8^255*t[2]<<0}function y(e){return e=Math.floor(e),[(255&e>>16)/255,(255&e>>8)/255,(255&e)/255]}function g(e,t,i){if(0===t)return[i,i,i];var r=.5>=i?i*(1+t):i+t-i*t,n=2*i-r;return[S(n,r,e+1/3),S(n,r,e),S(n,r,e-1/3)]}function S(e,t,i){return 0>i&&(i+=1),i>1&&(i-=1),1/6>i?e+6*(t-e)*i:.5>i?t:2/3>i?e+6*(t-e)*(2/3-i):e}function L(e){if(Pt[e])return y(Pt[e]);if(/^hsl/i.test(e)){var t=e.split(/,|\(/).map(parseFloat);return g(t[1]/360,t[2]/100,t[3]/100)}if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(e)){var i=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(e);return[Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255]}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(e)){var i=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(e);return[Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100]}if(/^\#([0-9a-f]{6})$/i.test(e)){var i=/^\#([0-9a-f]{6})$/i.exec(e);return y(parseInt(i[1],16))}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e)){var i=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e);return y(parseInt(i[1]+i[1]+i[2]+i[2]+i[3]+i[3],16))}return!1}function T(){function e(){for(var e=-1;++e<c;)l.update()}function t(){}function i(){}function r(){}function n(){return l.mergeProgram(simulation_vs,particleShader),this}function a(){}function s(e){var t=e().shared("uv","tex1.xy").map("gl_fragcolor = texel(uv);").pipe(h),i=e().sort("float comparator(vec2 a, vec2 b) { return a > b ? a : b }").map("bsearch").pipe(t),r="void main (){float a = texel(uv);float maxC = max(a.r, a.g, a.b)float minC = min(a.r, a.g, a.b)float lightness = (maxC + minC) * .5float  delta = maxC - minCfloat saturation = lightness <= 0.5 ? delta / ( maxC + minC ) : delta / ( 2 - maxC - minC )float hue = maxC == a.r ?  (a.g - a.b ) / delta + ( a.g < a.b ? 6 : 0 ): maxC == a.g  ? ( a.b - a.r ) / delta + 2: ( a.r - a.g ) / delta + 4;hue /= 6gl_FragColor = vec3(hue, saturation, threadIdx.xy);}";return dependencies.map(function(n){var a=e().blocksize(64,64).gridsize(8,8).map(r).reduce(e).pipe(i);n.pipe(a),n[1].pipe(t)}),this}function o(e){return l.drawTo(e),e&&h.push(e),u}var c=2,h=[],u={scatter:t,reduce:r,scan:i,map:n,match:s,pipe:o,invalidate:a},l=W({gl:It,batch:E()});return u.render=l,Ot.push(e),u}function E(){return Q(It,{xy:{array:u(),size:2},attrList:["xy"],count:6,primitive:"triangles"})}function x(e,t,i,r){function n(t,i){var r,n=e.getUniformLocation(Nt,t),a="uniform"+k(i);Nt[t]=function(t){t.map&&t.length>4?e[a](n,e.FALSE,Array.isArray(t)?t:[t]):e[a](n,Array.isArray(t)?t:[t]),r=t}}t=t.replace("//chunks",Ft.join("\n"));var a=t+"\n"+i;Nt=e.createProgram();var s=F(e,e.VERTEX_SHADER,t),o=F(e,e.FRAGMENT_SHADER,i);if(e.attachShader(Nt,s),e.attachShader(Nt,o),e.deleteShader(s),e.deleteShader(o),(r||["xy","color","r","fugue"]).forEach(function(t,i){e.bindAttribLocation(Nt,i,t)}),e.linkProgram(Nt),e.useProgram(Nt),!e.getProgramParameter(Nt,e.LINK_STATUS))throw name+": "+e.getProgramInfoLog(Nt);for(var c=/uniform\s+(\S+)\s+(\S+)\s*;/g,h=null;null!=(h=c.exec(a));)n(h[2],h[1]);return Nt.merge=A(s,o),Nt.gl=e,Nt}function w(e,t){h(t||{},function(e,t,i){"cx"==t&&(i.x=e),"cy"==t&&(i.y=e)});var i=p({stroke:"(stroke < 0.) ? vec4(stroke)  : unpack_color(stroke)",r:"(r.x < 0.) ? clamp(abs(tex(xy.xy).w) + abs(tex(xy.xy).z) * 4., 2., 10.): (2. * r.x)",x:"(xy.x < 1.) ? tex(xy.xy).x * resolution.x : xy.x",y:"(xy.y < 1.) ? tex(xy.xy).y * resolution.y : xy.y"},t);for(var r in i)e=e.replace("replace_"+r,i[r]);return e}function F(e,t,i){var r="precision mediump float;\n",n=e.createShader(t);if(e.shaderSource(n,r+i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(n)||"",s=+a.split(":")[2];return console.error((i||"").split("\n").slice(s-5,s+5).join("\n"),a)}return n}function k(e){return"sampler2D"==e?"1i":e.match("mat")?"Matrix"+e[e.length-1]+"fv":e.match("vec")?e[e.length-1]+"fv":"1fv"}function A(){return function(e,t,i){return t=t||wt.fragmentShader,e=w(e,i),x(this.gl,e,t)}}function b(e){var t=wt.options=wt.options||{};if(t.beforeDraw=t.beforeDraw||function(){},!(It=M(canvas=e)))return!!console.log("webGL context could not be initialized");It.getExtension("OES_texture_float")||console.warn("does not support floating point textures"),Nt=x(It,w(wt.vertexShader),wt.fragmentShader),canvas.program=Nt,U(canvas),N(canvas);var i=W(canvas);return i.drawTo(null),Ot.push(i.update),I(It),q(),Ot.push(function(){wt.uniform("clock",Date.now()%1e7)}),canvas}function I(e){e.clearColor(0,0,0,0),e.blendFunc(e.SRC_ALPHA,e.ONE)}function N(e){function t(){wt.uniform("resolution",[e.width||960,e.height||500])}setInterval(t,100),e.addEventListener("click",O),e.addEventListener("mousemove",R),e.addEventListener("touchmove",P),e.addEventListener("touchstart",P),wt.uniform("mouse",wt.options.mouseOrigin||[.5,.5])}function O(){}function R(e){var t=canvas.getBoundingClientRect(),i=e.clientX-t.left-canvas.clientLeft,r=e.clientY-t.top-canvas.clientTop;wt.uniform("mouse",[i/t.width,r/t.height]),Y(0|i,0|r)}function P(e){var t=canvas.getBoundingClientRect();e=e.touches[0],wt.uniform("mouse",[e.clientX-t.left-canvas.clientLeft,e.clientY-t.top-canvas.clientTop])}function U(e){p(e,Ut).gl=It,window.d3&&(p(window.d3.selection.prototype,{vAttr:C,shader:B}),p(window.d3.transition.prototype,{vAttr:C,shader:B}))}function M(e){var t=e.getContext("webgl",wt.options)||e.getContext("experimental-webgl",wt.options);return t&&p(t,{viewportWidth:e.width,viewportHeight:e.height})}function C(e,t){return this.each(function(e,i){this.xy[this.indices[0]]=t(e,i)}),this}function B(e){return this.node().batch.mergeProgram(wt.vertexShader,wt.fragmentShader,e),this}function q(){for(var e,t=Ot.length;t--;)Ot[t]();for(e=bt,bt=[],Ct=e;Ct.length;)Ct.pop()();Mt(q)}function D(e){Dt.Perp(0,0,1);var t=[];Dt.StartShape(t);for(var i=0;i<e.length;i++){Dt.StartCurve();for(var r=e[i],n=0;n<r.length;n+=2){var a=[r[n],r[n+1],0];Dt.point(a,a)}Dt.EndCurve()}return Dt.EndShape(),t}function z(){this.state=z.cond.T_SLEEP,this.perp=[0,0,0],this.s=[0,0,0],this.t=[0,0,0],this.relEpsilon=z._EPSILON,this.command=z.command.COMM_ODD,this.storeCount=0,this.store=new Array(z.MALA_MAX_STORE);for(var e=0;e<z.MALA_MAX_STORE;e++)this.store[e]=new z.storepoint}function G(e){var t=[],i=[0,0],r=[0,0],n=[t];e.slice().replace(/([MLHVCSQTAZmlhvcsqtaz])/g,"###$1").split(/###/).slice(1).forEach(function(e){for(var a=e.slice(1).trim().split(/\s|,|###/),s=0;s<a.length;){var o=a[s++],c=a[s++];switch(e[0].toLowerCase()){case"m":t.push(r[0],r[1]),r=i=[o,c],n.push(t=[]),t.push(i[0],i[1]);break;case"l":t.push(o,c),i=[o,c];break;case"z":i=r,t.push(i[0],i[1])}}}),this.indices=this.batch.spread(this.indices,D(n))}function X(){if(!d3)return console.warn("this method depends on d3");d3.selectAll("link[rel=styleSheet]").each(function(){d3.text});var e=d3.selectAll("style")[0].map(function(){return this.sheet}).reduce(function(e,t){var i={};return h(t.cssRules,function(e){for(var t=e.length,r={};t--;){var n=e[e[t]];r[n]=e[n]}i[e.selectorText]=r}),p(e,i)},{});h(e,function(e,t){d3.select(t).attr(e)})}function H(){(zt[0|this.attr.cx]=zt[0|this.attr.cx]||{})[0|this.attr.cy]=this}function Y(e,t){zt[e]&&zt[e][t]&&console.log("123"),zt[e]&&zt[e][t]&&Gt.push(zt[e][t].trigger("mouseover"))}function V(e){this.target=e}function $(e){var t=[];this.length=this.max=e,this.push=function(e){return t.push(e),++this.length},this.pop=function(){return t.length?t.pop():this.max-this.length--},this.splice=function(e,t){for(var i=[];i.length<t;)i.push(this.pop());return i}}function Q(e,t){function i(){return"triangles"==t.primitive?[]:"points"==t.primitive?[2*v.pop()]:"lines"==t.primitive?[2*v.pop(),2*v.pop()]:[]}function r(e,t){var i=t.length-e.length;i>0?e=e.concat(v.splice(v.length-i,i)):v.push.apply(v,e.splice(v.length+i,-i));var r=f.xy.array;return e.forEach(function(e){r[e]=t[e]}),e}function n(){d.forEach(function(i,r){var n=e.createBuffer(),a=t[i]||{};e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,17e6,e.STATIC_DRAW),f[i]={array:new Float32Array(t[i]&&t[i].array||4e6),buffer:n,size:a.size||2,loc:r}})}function a(e){var t,i;for(i in f)for(i=f,t=i.size;t--;)f[e*i.size+t]=0}function s(e){e.xyBuffer=f.xy.array,e.rBuffer=f.r.array,e.fBuffer=f.fugue.array,e.colorBuffer=f.color.array,e.batch=this}function o(i){if(p||0!=v.max-v.length){for(var r in f)r=f[r],e.bindBuffer(e.ARRAY_BUFFER,r.buffer),e.vertexAttribPointer(r.loc,r.size,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.loc),m.changed&&e.bufferSubData(e.ARRAY_BUFFER,0,r.array);m.changed=!1,wt.options.beforeDraw&&wt.options.beforeDraw(t),e.drawArrays(_,i,v.max-v.length||t.count||0)}}function c(){}function h(){}function u(){}function l(){}var f={},p=t.count||0,d=t.attrList||["xy","color","r","fugue"],_=e[t.primitive.toUpperCase()],v=new $(1e6);n();var m={init:n,free:a,tessOffset:0,alloc:i,draw:o,bind:s,attributes:f,set:c,addAttr:h,removeAttr:u,boundingBox:l,spread:r,changed:!0};return m}function W(e){function t(t){return t?(c.push(j(t)),this.mats.push(t),e.width=t.width,e.height=t.height,void 0):c.push(null)}function i(e){return(u[e.toLowerCase()]||console.log.bind(console,"Error"))(e)}function r(e,t,i){h=h.merge(e,t,i)}function n(){Nt!=h&&o.useProgram(Nt=h);for(var t=-1;++t<c.length;){c[t]?o.disable(o.BLEND):o.enable(o.BLEND),o.bindFramebuffer(o.FRAMEBUFFER,c[t]),a(),f.mats.forEach(function(e,t){e.bind(t)}),s(o,e);for(var i=-1;++i<l.length;)l[i].draw()}}function a(){for(var e in Rt)Nt[e]&&Nt[e](Rt[e])}function s(e,t){e.viewport(0,0,t.width,t.height)}var o=e.gl,c=[],h=e.program||Nt,u=e.types=ut(),l=e.batch?[e.batch]:Z(o,e.types);l.forEach(function(e){e.mergeProgram=r});var f={update:n,append:i,drawTo:t,mergeProgram:r,mats:[],read:function(e){console.log(e),this.mats.push(e)}};return e.__renderTarget__=f}function Z(e,t){var i=new Q(e,{primitive:"points"});i.bind(t.circle);var r=new Q(e,{primitive:"lines"});r.bind(t.line);var n=new Q(e,{primitive:"triangles"});return n.bind(t.path),n.bind(t.rect),[i,n,r]}function j(e){var t=It.createFramebuffer();return It.bindFramebuffer(It.FRAMEBUFFER,t),t.width=e.width,t.height=e.height,It.framebufferTexture2D(It.FRAMEBUFFER,It.COLOR_ATTACHMENT0,It.TEXTURE_2D,e.id,null),It.bindFramebuffer(It.FRAMEBUFFER,null),t}function K(e){return this.querySelectorAll(e)[0]}function J(e,t){return e.replace(/^\s+|\s*([,\s\+\~>]|$)\s*/g,"$1").split(",").forEach(function(e){et(e,this).forEach(s.bind(t=[]))},this)||t}function et(e,t){var i,r=e.split(/[\s\>\+\~](?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),n=e.match(/([\s\>\+\~])(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\]|[\s\w\+\-]*\))/),a=nt(r.pop()),s=[],o=[];return ct.call(t,a[1]||"*").forEach(function(e){(i=it.apply(e,a))&&s.push(i)}),r.length?s.forEach(function(e){tt(e,r,n)&&o.push(e)})||o:s}function tt(e,t,i,r){return r=function n(e,a,s){for(;s=Ht[i[a]](s,e);)if(it.apply(s,nt(t[a]))&&a)return(r=n(s,a-1,s))?r:s}(e,t.length-1,e)}function it(e,t,i,r,n,a,s,e,o,e,c,h){return o&&Xt[o]&&!Xt[o](this,c)||t&&"*"!==t&&this.tag&&this.tag.toLowerCase()!==t||r&&!rt(a,(this.attr[n]||"").toString(),s)||i&&(h=i.match(/#([\w\-]+)/))&&h[1]!==this.attr.id||i&&(i.match(/\.[\w\-]+/g)||[]).some(ot.bind(this))?0:this}function rt(e,t,i){return t.toString().match(RegExp({"=":i,"^=":"^"+st(i),"$=":st(i)+"$","*=":st(i),"~=":"(?:^|\\s+)"+st(i)+"(?:\\s+|$)","|=":"^"+st(i)+"(-|$)"}[e]||"adnan^"))}function nt(e){return e.match(Yt)}function at(e){for(;e=e.previousSibling();)if(e.top)return e}function st(e){return e.replace(/([.*+?\^=!:${}()|\[\]\/\\])/,"\\$1")}function ot(e){return!RegExp("(^|\\s+)"+e.slice(1)+"(\\s+|$)").test(this.attr.class)}function ct(e){return ht(this,function(t){return"*"==e||t.tagName==e},[])}function ht(e,t,i){return(e.__scene__||e.children).forEach(function(e){ht(e,t,i),t(e)&&i.push(e)})||i}function ut(){return Wt.reduce(function(e,t){return e[t.name]=function i(){var e=Object.create(t.prototype);return p(e,i),e.init(e.batch.alloc()),e.attr=Object.create(Vt),e},p(t.prototype,Qt,$t[t.name],{tagName:t.name}),e},{})}function lt(e){G.call(this,e),this.fill(this.attr.stroke)}function ft(e,t){var i=canvas.__scene__,r=i.indexOf(t);reverseEach(i.slice(r,i.push(0)),function(e,t){i[t]=i[t-1]}),i[r]=e}function pt(e){return this.__scene__[this.__scene__.length]=this.__renderTarget__.append(e.tagName)}function dt(e){var t=this.__scene__.indexOf(e);e=this.__scene__.splice(t,1)[0],e&&e.batch.free(t)}function _t(){var e=canvas.getBoundingClientRect();return{a:1,b:0,c:0,d:1,e:this.attr.cx+e.left,f:this.attr.cy+e.top}}function vt(){return{height:10,width:10,y:this.attr.cy,x:this.attr.cx}}function mt(e,t){"string"==typeof e&&(e=gt(e)),t=t||{},p(this,{gl:It,data:e,init:yt,dependents:[],id:It.createTexture(),cursor:0,val:kt(),slots:t.slots||1,invalidate:function(){}}),"number"==typeof e?(this.height=Math.sqrt(c(e)),this.width=this.slots*this.height,this.data=!1,yt.call(this)):Et.call(this)}function yt(){var e=f.call(this),t=It[e?"REPEAT":"CLAMP_TO_EDGE"],i=It[e?"LINEAR":"NEAREST"];It.bindTexture(It.TEXTURE_2D,this.id),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MAG_FILTER,i),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_MIN_FILTER,i),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_S,t),It.texParameteri(It.TEXTURE_2D,It.TEXTURE_WRAP_T,t),this.update()}function gt(e){try{var t=document.querySelector(e);if(t)return t}catch(i){}return p(l?new Image:document.createElement("video"),{crossOrigin:"anonymous",src:e})}function St(e){return e.render.read(this),this}function Lt(){for(var e=this.width*this.height/this.slots||0,t=new Array(e);e--;)t[e]={x:this.x()(0,e*this.slots),y:this.y()(0,e*this.slots)};return t}function Tt(){p(this,{__scene__:[]}),(this.__renderTarget__=W(this)).drawTo(this);var e=this.update;this.update=function(){e.call(this),this.__renderTarget__.update()}}function Et(){var e=this.data;return d(e,function(){this.width=e.width||512,this.height=e.height||512,this.data=e,yt.call(this)}.bind(this)),this}function xt(e,t,i){var r=0|this.slots*this.cursor%this.width,n=0|this.slots*this.cursor/this.height,a=[{x:r,y:n,size:e*this.slots}],s=this.height;i=i||function(){return 1-2*Math.random()};var o=a[0];do{var c=o.x+o.size,h=c-s;o.size-=h,a.push(o={x:0,y:(o.y+1)%s,size:h})}while(c>s);for(var u=0;u<a.length;u++){var l=[],f=-1;for(o=a[u];++f<o.size;)l.push(t[0],t[1],i(f),i(f));this.subImage(o.x,o.y,l)}this.cursor+=e,this.cursor%=this.size(),this.invalidate()}var wt=this.pathgl={};wt.stop=function(){},wt.context=function(){return It};var Ft=[],kt=function(e){return function(){return e++}}(1),At=0,bt=[];wt.texture=function(e,t){return At||wt.init("canvas"),new mt(e||!1,t)},wt.uniform=function(e,t){return 1==arguments.length?Rt[e]:Rt[e]=t},wt.registerChunk=function(e){Ft.push(e)},wt.applyCSS=X,HTMLCanvasElement.prototype.appendChild=function(e){return wt.init(this)?this.appendChild(e):void 0};var It,Nt,Ot=[],Rt={};wt.init=function(e){return At=1,e="string"==typeof e?document.querySelector(e):e instanceof d3.selection?e.node():e,e.getContext?!!b(e):console.log(e,"is not a valid canvas")},e.INIT_SIZE_=32,e.prototype.init=function(){this.order_=[];for(var e=0;e<this.size_;e++)this.order_[e]=e;var t=function(e,t){return function(i,r){return t(e[i],e[r])?1:-1}}(this.keys_,this.leq_);this.order_.sort(t),this.max_=this.size_,this.initialized_=!0,this.heap_.init();var i=0,r=i+this.size_-1;for(e=i;r>e;++e)Bt(this.leq_(this.keys_[this.order_[e+1]],this.keys_[this.order_[e]]))},e.prototype.add=function(t){if(this.initialized_)return this.heap_.add(t);var i=this.size_;return++this.size_>=this.max_&&(this.max_*=2,this.keys_=e.prototype.PQKeyRenew_(this.keys_,this.max_)),this.keys_[i]=t,-(i+1)},e.prototype.PQKeyRenew_=function(e,t){var i=new Array(t),r=0;if(e!==!1)for(;r<e.length;r++)i[r]=e[r];for(;t>r;r++)i[r]=!1;return i},e.prototype.keyLessThan_=function(e,t){var i=this.keys_[e],r=this.keys_[t];return!this.leq_(r,i)},e.prototype.keyGreaterThan_=function(e,t){var i=this.keys_[e],r=this.keys_[t];return!this.leq_(i,r)},e.prototype.findMin=function(){if(0===this.size_)return this.heap_.findMin();var e=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(this.leq_(t,e))return this.heap_.findMin()}do--this.size_;while(this.size_>0&&this.keys_[this.order_[this.size_-1]]===!1);return e},e.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var e=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var t=this.heap_.minimum();if(this.leq_(t,e))return t}return e},e.prototype.isEmpty=function(){return 0===this.size_&&this.heap_.isEmpty()},e.prototype.remove=function(e){if(e>=0)return this.heap_.remove(e);for(e=-(e+1),Bt(e<this.max_&&this.keys_[e]!==!1),this.keys_[e]=!1;this.size_>0&&this.keys_[this.order_[this.size_-1]]===!1;)--this.size_},t.INIT_SIZE_=32,t.prototype.killHeap=function(){this.handles_=!1,this.ns_=!1},t.prototype.init=function(){for(var e=this.size_;e>=1;--e)this.floatDown_(e);this.initialized_=!0},t.prototype.add=function(e){var t,n=++this.size_;return 2*n>this.max_&&(this.max_*=2,this.ns_=i.renew(this.ns_,this.max_+1),this.handles_=r.renew(this.handles_,this.max_+1)),0===this.fList_?t=n:(t=this.fList_,this.fList_=this.handles_[t].n),this.ns_[n].handle=t,this.handles_[t].n=n,this.handles_[t].key=e,this.initialized_&&this.floatUp_(n),t},t.prototype.isEmpty=function(){return 0===this.size_},t.prototype.minimum=function(){return this.handles_[this.ns_[1].handle].key},t.prototype.findMin=function(){var e=this.ns_,t=this.handles_,i=e[1].handle,r=t[i].key;return this.size_>0&&(e[1].handle=e[this.size_].handle,t[e[1].handle].n=1,t[i].key=!1,t[i].n=this.fList_,this.fList_=i,--this.size_>0&&this.floatDown_(1)),r},t.prototype.remove=function(e){var t=this.ns_,i=this.handles_;Bt(e>=1&&e<=this.max_&&i[e].key!==!1);var r=i[e].n;t[r].handle=t[this.size_].handle,i[t[r].handle].n=r,r<=--this.size_&&(1>=r||this.leq_(i[t[r>>1].handle].key,i[t[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),i[e].key=!1,i[e].n=this.fList_,this.fList_=e},t.prototype.floatDown_=function(e){for(var t=this.ns_,i=this.handles_,r=t[e].handle;;){var n=e<<1;n<this.size_&&this.leq_(i[t[n+1].handle].key,i[t[n].handle].key)&&++n,Bt(n<=this.max_);var a=t[n].handle;if(n>this.size_||this.leq_(i[r].key,i[a].key))return t[e].handle=r,i[r].n=e;t[e].handle=a,i[a].n=e,e=n}},t.prototype.floatUp_=function(e){for(var t=this.ns_,i=this.handles_,r=t[e].handle;;){var n=e>>1,a=t[n].handle;if(0===n||this.leq_(i[a].key,i[r].key))return t[e].handle=r,i[r].n=e;t[e].handle=a,i[a].n=e,e=n}},i.renew=function(e,t){var r=new Array(t),n=0;if(e!==!1)for(;n<e.length;n++)r[n]=e[n];for(;t>n;n++)r[n]=new i;return r},r.renew=function(e,t){var i=new Array(t),n=0;if(e!==!1)for(;n<e.length;n++)i[n]=e[n];for(;t>n;n++)i[n]=new r;return i},!function(){var e,t,i=document.createElement("canvas").getContext("2d"),r=i.canvas.width=i.canvas.height=128;for(e=0;r>e;e+=16)for(t=0;r>t;t+=16)i.fillStyle=16&(t^e)?"#FFF":"#DDD",i.fillRect(t,e,16,16);return i.canvas}();var Pt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wt.shader=T,wt.vertexShader=["uniform float clock;","uniform vec2 mouse;","uniform vec2 resolution;","uniform vec2 dates;","uniform vec4 baseColor;","uniform vec4 lightColor;","uniform float logo;","attribute vec2 xy;","attribute vec2 r;","attribute vec2 color;","attribute vec2 fugue;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","varying vec4 dim;","uniform sampler2D texture0;","vec4 tex(vec2 get) { ","  return texture2D(texture0, abs(get));","}","vec4 unpack_color(float col) {","    return vec4(mod(col / 256. / 256., 256.),","                mod(col / 256. , 256.),","                mod(col, 256.),","                256. - fugue.x)","                / 256.;","}","vec2 clipspace(vec2 pos) { return vec2(2. * (pos.x / resolution.x) - 1., 1. - ((pos.y / resolution.y) * 2.)); }","float noise (){ return ((sin(clock / 100.) + 1.) /2. + (sin(xy.x / 100.) + 1.) / 2.) / 2.  ;}","//chunks","void main() {","    float time = clock / 1000.;","    float pointSize = replace_r;","    float x = replace_x;","    float y = replace_y;","    float fill = color.x;","    float stroke = color.x;","    type = float(pointSize > 0.);","    gl_PointSize =  pointSize;","    v_fill = unpack_color(fill);","    dim = vec4(x, y, pointSize, -pointSize);","    v_stroke = replace_stroke;","    gl_Position = vec4(clipspace(vec2(x, y)),  1., 1.);","}"].join("\n"),wt.fragmentShader=["uniform vec2 resolution;","uniform vec2 dates;","uniform sampler2D texture0;","uniform sampler2D texture1;","varying float type;","varying vec4 v_stroke;","varying vec4 v_fill;","varying vec4 dim;","vec4 chos(vec2 get, float n) { ","  if (n == -1.)return texture2D(texture1, abs(get));","  if (n == -2.) return texture2D(texture0, abs(get));","}","vec2 clipspace(vec2 pos) { return vec2(2. * (pos.x / resolution.x) - .5, 1. - ((pos.y / resolution.y))); }","void main() {","    float dist = distance(gl_PointCoord, vec2(0.5));","    if (type == 1. && dist > 0.5) discard;","    gl_FragColor = (v_stroke.x < 0.) ? chos(clipspace(dim.xy) * 2., -1.0)  : v_stroke;","}"].join("\n");var Ut={appendChild:pt,querySelectorAll:J,querySelector:function(e){return this.querySelectorAll(e)[0]},removeChild:dt,insertBefore:ft,ownerSVGElement:{createSVGPoint:function Zt(e,t){return{y:t||0,x:e||0,matrixTransform:function(e){return Zt(e.e,e.f)}}}},__scene__:[],__program__:void 0},Mt=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},Ct=[],Bt=function(e){_(e,"Could not Triangulate...")};z.sweepDebugEvent=function(){},z.MAX_XY=1e150,z.MALA_MAX_STORE=100,z.EPSILON=0,z.S__X_=1,z.S__Y_=0,z.SIGN_INCONSISTENT_=2,z.cond={T_SLEEP:0,T_IN_SHAPE:1,T_IN_CURVE:2},z.command={COMM_ODD:100130,COMM_NONZERO:100131,COMM_POSITIVE:100132,COMM_NEGATIVE:100133,COMM_ABS_GEQ_TWO:10013};var qt={LINE_LOOP:2,MALAANGLES:4,MALAANGLE_SMALAP:5,MALAANGLE_FAN:6};z.failureType={MISSING_START_SHAPE:100151,MISSING_END_SHAPE:100153,MISSING_START_CURVE:100152,MISSING_END_CURVE:100154,XY_TOO_BIG:100155,NEED_COMBINE_BACK:100156},z.opt={SURFACE:100112,EPSILON:100142,COMM_RULE:100140,LINE_ONLY:100141,INVALID_:100900,INVALID_VALUE:100901,START:100100,POINT:100101,END:100102,FAILURE:100103,LINE_FLAG:100104,COMBINE:100105,START_STAT:100106,POINT_STAT:100107,END_STAT:100108,FAILURE_STAT:100109,LINE_FLAG_STAT:100110,COMBINE_STAT:100111},z.storepoint=function(){this.xys=[0,0,0]},z.prototype.Perp=function(e,t,i){this.perp[0]=e,this.perp[1]=t,this.perp[2]=i},z.prototype.on=function(e,t){return t=t||!1,z.opt.START&&(this.Start_=t),e==z.opt.START_STAT&&(this.StartStat_=t),e==z.opt.LINE_FLAG&&(this.flagLine=!!t),e==z.opt.LINE_FLAG_STAT&&(this.flagLine=!!t),e==z.opt.POINT&&(this.point_=t),e==z.opt.POINT_STAT&&(this.pointStat_=t),e==z.opt.END&&(this.End_=t),e==z.opt.END_STAT&&(this.EndStat_=t),e==z.opt.FAILURE&&(this.Failure_=t),e==z.opt.FAILURE_STAT&&(this.FailureStat_=t),e==z.opt.COMBINE&&(this.Combine_=t),e==z.opt.COMBINE_STAT&&(this.CombineStat_=t),e==z.opt.SURFACE&&(this.layer_=t),this},z.prototype.point=function(e,t){var i=!1,r=[0,0,0];this.requireState_(z.cond.T_IN_CURVE),this.es&&(this.empty_store(),this.lastLine_=!1);for(var n=0;3>n;++n){var a=e[n];a<-z.MAX_XY&&(a=-z.MAX_XY,i=!0),a>z.MAX_XY&&(a=z.MAX_XY,i=!0),r[n]=a}if(i&&this.FailureOrFailureStat(z.failureType.XY_TOO_BIG),this.surface===!1){if(this.storeCount<z.MALA_MAX_STORE)return this.sp(r,t);this.empty_store()}this.addpoint_(r,t)},z.prototype.StartShape=function(e){this.requireState_(z.cond.T_SLEEP),this.state=z.cond.T_IN_SHAPE,this.storeCount=0,this.es=!1,this.surface=!1,this.shapeStat_=e},z.prototype.StartCurve=function(){this.requireState_(z.cond.T_IN_SHAPE),this.state=z.cond.T_IN_CURVE,this.lastLine_=!1,this.storeCount>0&&(this.es=!0)},z.prototype.EndCurve=function(){this.requireState_(z.cond.T_IN_CURVE),this.state=z.cond.T_IN_SHAPE},z.prototype.EndShape=function(){if(this.requireState_(z.cond.T_IN_SHAPE),this.state=z.cond.T_SLEEP,this.surface===!1){if(!this.flagLine&&!this.layer_&&z.drawStore(this))return this.shapeStat_=!1;this.empty_store()}return z.projectShape(this),z.computeInner(this),!this.fatalFailure&&(this.lineOnly?z.FollowId(this.surface,1,!0):z.patchInner(this.surface),this.surface.fixlayer(),(this.Start_||this.End_||this.point_||this.LineFlag_||this.StartStat_||this.EndStat_||this.pointStat_||this.LineFlagStat_)&&(this.lineOnly?z.drawLine(this,this.surface):z.drawlayer(this,this.surface)),this.layer_)?(z.discardOuter(this.surface),this.layer_(this.surface),this.surface=!1,this.shapeStat_=!1):(z.surface.killlayer(this.surface),this.shapeStat_=!1,this.surface=!1,void 0)},z.prototype.makeSleep_=function(){this.surface&&z.surface.killlayer(this.surface),this.state=z.cond.T_SLEEP,this.lastLine_=!1,this.surface=!1},z.prototype.requireState_=function(e){this.state!==e&&this.gotoState_(e)},z.prototype.gotoState_=function(e){for(;this.state!==e;)if(this.state<e)switch(this.state){case z.cond.T_SLEEP:return this.FailureOrFailureStat(z.failureType.MISSING_START_SHAPE),this.StartShape(!1);case z.cond.T_IN_SHAPE:return this.FailureOrFailureStat(z.failureType.MISSING_START_CURVE),this.StartCurve()}else switch(this.state){case z.cond.T_IN_CURVE:return this.FailureOrFailureStat(z.failureType.MISSING_END_CURVE),this.EndCurve();case z.cond.T_IN_SHAPE:return this.FailureOrFailureStat(z.failureType.MISSING_END_SHAPE),this.makeSleep_()}},z.prototype.addpoint_=function(e,t){var i=this.lastLine_;i===!1?(i=z.surface.makeLine(this.surface),z.surface.surfaceSplit(i,i.sym)):(z.surface.splitLine(i),i=i.lThere),i.org.stat=t,i.org.xys[0]=e[0],i.org.xys[1]=e[1],i.org.xys[2]=e[2],i.follow=1,i.sym.follow=-1,this.lastLine_=i},z.prototype.sp=function(e,t){var i=this.store[this.storeCount];i.stat=t,i.xys[0]=e[0],i.xys[1]=e[1],i.xys[2]=e[2],++this.storeCount},z.prototype.empty_store=function(){this.surface=new z.layer;for(var e=0;e<this.storeCount;e++){var t=this.store[e];this.addpoint_(t.xys,t.stat)}this.storeCount=0,this.es=!1},z.prototype.StartOrStartStat=function(e){this.StartStat_?this.StartStat_(e,this.shapeStat_):this.Start_&&this.Start_(e)},z.prototype.pointOrpointStat=function(e){this.pointStat_?this.pointStat_(e,this.shapeStat_):this.point_&&this.point_(e)},z.prototype.LineFlagOrLineFlagStat=function(e){this.LineFlagStat_?this.LineFlagStat_(e,this.shapeStat_):this.LineFlag_&&this.LineFlag_(e)},z.prototype.EndOrEndStat=function(){this.EndStat_?this.EndStat_(this.shapeStat_):this.End_&&this.End_()},z.prototype.CombineOrCombineStat=function(e,t,i){var r=this.CombineStat_?this.CombineStat_(e,t,i,this.shapeStat_):this.Combine_(e,t,i);return void 0===r?r=!1:r},z.prototype.FailureOrFailureStat=function(e){this.FailureStat_?this.FailureStat_(e,this.shapeStat_):this.Failure_&&this.Failure_(e)},z.DictN=function(){this.key=!1,this.there=!1,this.prev=!1},z.Dict=function(e,t){this.start=new z.DictN,this.start.there=this.start,this.start.prev=this.start,this.frame=e,this.leq_=t},z.Dict.prototype.addBefore=function(e,t){do e=e.prev;while(e.key!==!1&&!this.leq_(this.frame,e.key,t));var i=new z.DictN;return i.key=t,i.there=e.there,e.there.prev=i,i.prev=e,e.there=i,i},z.Dict.prototype.add=function(e){return this.addBefore(this.start,e)},z.Dict.prototype.killN=function(e){e.there.prev=e.prev,e.prev.there=e.there},z.Dict.prototype.search=function(e){var t=this.start;do t=t.there;while(t.key!==!1&&!this.leq_(this.frame,e,t.key));return t},z.PQN=function(){this.handle=0},z.PQN.renew=function(e,t){var i=new Array(t),r=0;if(e!==!1)for(;r<e.length;r++)i[r]=e[r];for(;t>r;r++)i[r]=new z.PQN;return i},z.PQHandleElem=function(){this.key=!1,this.n=0},z.PQHandleElem.renew=function(e,t){var i=new Array(t),r=0;if(e!==!1)for(;r<e.length;r++)i[r]=e[r];for(;t>r;r++)i[r]=new z.PQHandleElem;return i},z.fixOrientation_=function(e){for(var t=0,i=e.surface.fStart,r=i.there;r!==i;r=r.there){var n=r.anLine;if(!(n.follow<=0))do t+=(n.org.s-n.dst().s)*(n.org.t+n.dst().t),n=n.lThere;while(n!==r.anLine)}if(0>t){for(var a=e.surface.vStart,s=a.there;s!==a;s=s.there)s.t=-s.t;e.t[0]=-e.t[0],e.t[1]=-e.t[1],e.t[2]=-e.t[2]}},z.patchSpace_=function(e){var t=e.anLine;for(Bt(t.lThere!==t&&t.lThere.lThere!==t);z.pointLeq(t.dst(),t.org);)t=t.lPrev();
for(;z.pointLeq(t.org,t.dst());)t=t.lThere;for(var i,r=t.lPrev();t.lThere!==r;)if(z.pointLeq(t.dst(),r.org)){for(;r.lThere!==t&&(z.lineGoesLeft(r.lThere)||z.lineSign(r.org,r.dst(),r.lThere.dst())<=0);)i=z.surface.connect(r.lThere,r),r=i.sym;r=r.lPrev()}else{for(;r.lThere!==t&&(z.lineGoesRight(t.lPrev())||z.lineSign(t.dst(),t.org,t.lPrev().org)>=0);)i=z.surface.connect(t,t.lPrev()),t=i.sym;t=t.lThere}for(Bt(r.lThere!==t);r.lThere.lThere!==t;)i=z.surface.connect(r.lThere,r),r=i.sym},z.surface=function(){},z.surface.makeLine=function(e){var t=z.surface.makeLinePair_(e.eStart);return z.surface.makepoint_(t,e.vStart),z.surface.makepoint_(t.sym,e.vStart),z.surface.makeFace_(t,e.fStart),t},z.surface.surfaceSplit=function(e,t){var i=!1,r=!1;e!==t&&(t.org!==e.org&&(r=!0,z.surface.killpoint_(t.org,e.org)),t.lFace!==e.lFace&&(i=!0,z.surface.killFace_(t.lFace,e.lFace)),z.surface.split_(t,e),r||(z.surface.makepoint_(t,e.org),e.org.anLine=e),i||(z.surface.makeFace_(t,e.lFace),e.lFace.anLine=e))},z.surface.killLine=function(e){var t=e.sym,i=!1;e.lFace!==e.rFace()&&(i=!0,z.surface.killFace_(e.lFace,e.rFace())),e.oThere===e?z.surface.killpoint_(e.org,!1):(e.rFace().anLine=e.oPrev(),e.org.anLine=e.oThere,z.surface.split_(e,e.oPrev()),i||z.surface.makeFace_(e,e.lFace)),t.oThere===t?(z.surface.killpoint_(t.org,!1),z.surface.killFace_(t.lFace,!1)):(e.lFace.anLine=t.oPrev(),t.org.anLine=t.oThere,z.surface.split_(t,t.oPrev())),z.surface.killLine_(e)},z.surface.addLinepoint=function(e){var t=z.surface.makeLinePair_(e),i=t.sym;return z.surface.split_(t,e.lThere),t.org=e.dst(),z.surface.makepoint_(i,t.org),t.lFace=i.lFace=e.lFace,t},z.surface.splitLine=function(e){var t=z.surface.addLinepoint(e),i=t.sym;return z.surface.split_(e.sym,e.sym.oPrev()),z.surface.split_(e.sym,i),e.sym.org=i.org,i.dst().anLine=i.sym,i.sym.lFace=e.rFace(),i.follow=e.follow,i.sym.follow=e.sym.follow,i},z.surface.connect=function(e,t){var i=!1,r=z.surface.makeLinePair_(e),n=r.sym;return t.lFace!==e.lFace&&(i=!0,z.surface.killFace_(t.lFace,e.lFace)),z.surface.split_(r,e.lThere),z.surface.split_(n,t),r.org=e.dst(),n.org=t.org,r.lFace=n.lFace=e.lFace,e.lFace.anLine=n,i||z.surface.makeFace_(r,e.lFace),r},z.surface.zapFace=function(e){var t,i=e.anLine,r=i.lThere;do if(t=r,r=t.lThere,t.lFace=!1,t.rFace()===!1){t.oThere===t?z.surface.killpoint_(t.org,!1):(t.org.anLine=t.oThere,z.surface.split_(t,t.oPrev()));var n=t.sym;n.oThere===n?z.surface.killpoint_(n.org,!1):(n.org.anLine=n.oThere,z.surface.split_(n,n.oPrev())),z.surface.killLine_(t)}while(t!==i);var a=e.prev,s=e.there;s.prev=a,a.there=s},z.surface.surfaceUnion=function(e,t){var i=e.fStart,r=e.vStart,n=e.eStart,a=t.fStart,s=t.vStart,o=t.eStart;return a.there!==a&&(i.prev.there=a.there,a.there.prev=i.prev,a.prev.there=i,i.prev=a.prev),s.there!==s&&(r.prev.there=s.there,s.there.prev=r.prev,s.prev.there=r,r.prev=s.prev),o.there!==o&&(n.sym.there.sym.there=o.there,o.there.sym.there=n.sym.there,o.sym.there.sym.there=n,n.sym.there=o.sym.there),e},z.surface.killlayer=function(){},z.surface.makeLinePair_=function(e){var t=new z.HalfLine,i=new z.HalfLine,r=e.sym.there;return i.there=r,r.sym.there=t,t.there=e,e.sym.there=i,t.sym=i,t.oThere=t,t.lThere=i,i.sym=t,i.oThere=i,i.lThere=t,t},z.surface.split_=function(e,t){var i=e.oThere,r=t.oThere;i.sym.lThere=t,r.sym.lThere=e,e.oThere=r,t.oThere=i},z.surface.makepoint_=function(e,t){var i=t.prev,r=new z.point(t,i);i.there=r,t.prev=r,r.anLine=e;var n=e;do n.org=r,n=n.oThere;while(n!==e)},z.surface.makeFace_=function(e,t){var i=t.prev,r=new z.Face(t,i);i.there=r,t.prev=r,r.anLine=e,r.inside=t.inside;var n=e;do n.lFace=r,n=n.lThere;while(n!==e)},z.surface.killLine_=function(e){var t=e.there,i=e.sym.there;t.sym.there=i,i.sym.there=t},z.surface.killpoint_=function(e,t){var i=e.anLine,r=i;do r.org=t,r=r.oThere;while(r!==i);var n=e.prev,a=e.there;a.prev=n,n.there=a},z.surface.killFace_=function(e,t){var i=e.anLine,r=i;do r.lFace=t,r=r.lThere;while(r!==i);var n=e.prev,a=e.there;a.prev=n,n.there=a},z.Face=function(e,t){this.there=e||this,this.prev=t||this,this.anLine=!1,this.stat=!1,this.trail=!1,this.marked=!1,this.inside=!1},z.HalfLine=function(e){this.there=e||this,this.sym=!1,this.oThere=!1,this.lThere=!1,this.org=!1,this.lFace=!1,this.region=!1,this.follow=0},z.HalfLine.prototype.rFace=function(){return this.sym.lFace},z.HalfLine.prototype.dst=function(){return this.sym.org},z.HalfLine.prototype.oPrev=function(){return this.sym.lThere},z.HalfLine.prototype.lPrev=function(){return this.oThere.sym},z.HalfLine.prototype.dPrev=function(){return this.lThere.sym},z.HalfLine.prototype.rPrev=function(){return this.sym.oThere},z.HalfLine.prototype.dThere=function(){return this.rPrev().sym},z.HalfLine.prototype.rThere=function(){return this.oPrev().sym},z.point=function(e,t){this.there=e||this,this.prev=t||this,this.anLine=!1,this.stat=!1,this.xys=[0,0,0],this.s=0,this.t=0,this.pqHandle=!1},z.layer=function(){this.vStart=new z.point,this.fStart=new z.Face,this.eStart=new z.HalfLine,this.eStartSym=new z.HalfLine,this.eStart.sym=this.eStartSym,this.eStartSym.sym=this.eStart},z.layer.prototype.fixlayer=function(){var e,t,i=this.fStart,r=this.vStart,n=this.eStart,a=i;for(a=i;(t=a.there)!==i;a=t){Bt(t.prev===a),e=t.anLine;do Bt(e.sym!==e),Bt(e.sym.sym===e),Bt(e.lThere.oThere.sym===e),Bt(e.oThere.sym.lThere===e),Bt(e.lFace===t),e=e.lThere;while(e!==t.anLine)}Bt(t.prev===a&&t.anLine===!1&&t.stat===!1);var s,o=r;for(o=r;(s=o.there)!==r;o=s){Bt(s.prev===o),e=s.anLine;do Bt(e.sym!==e),Bt(e.sym.sym===e),Bt(e.lThere.oThere.sym===e),Bt(e.oThere.sym.lThere===e),Bt(e.org===s),e=e.oThere;while(e!==s.anLine)}Bt(s.prev===o&&s.anLine===!1&&s.stat===!1);var c=n;for(c=n;(e=c.there)!==n;c=e)Bt(e.sym.there===c.sym),Bt(e.sym!==e),Bt(e.sym.sym===e),Bt(e.org!==!1),Bt(e.dst()!==!1),Bt(e.lThere.oThere.sym===e),Bt(e.oThere.sym.lThere===e);Bt(e.sym.there===c.sym&&e.sym===this.eStartSym&&e.sym.sym===e&&e.org===!1&&e.dst()===!1&&e.lFace===!1&&e.rFace()===!1)},z.SENTINEL_XY_=4*z.MAX_XY,z.EPSILON_NONZERO_=!1,z.computeInner=function(e){e.fatalFailure=!1,z.removeDeadLines_(e),z.initPriorityQ_(e),z.initLineDict_(e);for(var t;(t=e.pq.findMin())!==!1;){for(;;){var i=e.pq.minimum();if(i===!1||!z.pointEq(i,t))break;i=e.pq.findMin(),z.splitMergePoints_(e,t.anLine,i.anLine)}z.sweepEvent_(e,t)}var r=e.dict.start.there.key;e.event=r.eUp.org,z.sweepDebugEvent(e),z.doneLineDict_(e),z.done(e),z.removeDeadFaces_(e.surface),e.surface.fixlayer()},z.addFollow_=function(e,t){e.follow+=t.follow,e.sym.follow+=t.sym.follow},z.lineLeq_=function(e,t,i){var r=e.event,n=t.eUp,a=i.eUp;if(n.dst()===r)return a.dst()===r?z.pointLeq(n.org,a.org)?z.lineSign(a.dst(),n.org,a.org)<=0:z.lineSign(n.dst(),a.org,n.org)>=0:z.lineSign(a.dst(),r,a.org)<=0;if(a.dst()===r)return z.lineSign(n.dst(),r,n.org)>=0;var s=z.lineEval(n.dst(),r,n.org),o=z.lineEval(a.dst(),r,a.org);return s>=o},z.killSpace_=function(e,t){t.fixUpperLine&&Bt(0===t.eUp.follow),t.eUp.region=!1,e.dict.killN(t.nUp),t.nUp=!1},z.fixUpperLine_=function(e,t){Bt(e.fixUpperLine),z.surface.killLine(e.eUp),e.fixUpperLine=!1,e.eUp=t,t.region=e},z.topLeftSpace_=function(e){var t=e.eUp.org;do e=e.spaceAbove();while(e.eUp.org===t);if(e.fixUpperLine){var i=z.surface.connect(e.spaceBelow().eUp.sym,e.eUp.lThere);z.fixUpperLine_(e,i),e=e.spaceAbove()}return e},z.topRightSpace_=function(e){var t=e.eUp.dst();do e=e.spaceAbove();while(e.eUp.dst()===t);return e},z.addSpaceBelow_=function(e,t,i){var r=new z.Region;return r.eUp=i,r.nUp=e.dict.addBefore(t.nUp,r),i.region=r,r},z.isFollowInside_=function(e,t){switch(e.command){case z.command.COMM_ODD:return 0!==(1&t);case z.command.COMM_NONZERO:return 0!==t;case z.command.COMM_POSITIVE:return t>0;case z.command.COMM_NEGATIVE:return 0>t;case z.command.COMM_ABS_GEQ_TWO:return t>=2||-2>=t}return Bt(!1),!1},z.computeFollow_=function(e,t){t.followId=t.spaceAbove().followId+t.eUp.follow,t.inside=z.isFollowInside_(e,t.followId)},z.finishSpace_=function(e,t){var i=t.eUp,r=i.lFace;r.inside=t.inside,r.anLine=i,z.killSpace_(e,t)},z.finishLeftSpaces_=function(e,t,i){for(var r=t,n=t.eUp;r!==i;){r.fixUpperLine=!1;var a=r.spaceBelow(),s=a.eUp;if(s&&s.org!==n.org){if(!a.fixUpperLine){z.finishSpace_(e,r);break}s=z.surface.connect(n.lPrev(),s.sym),z.fixUpperLine_(a,s)}n.oThere!==s&&(z.surface.surfaceSplit(s.oPrev(),s),z.surface.surfaceSplit(n,s)),z.finishSpace_(e,r),n=a.eUp,r=a}return n},z.addRightLines_=function(e,t,i,r,n,a){var s=!0,o=i;do Bt(z.pointLeq(o.org,o.dst())),z.addSpaceBelow_(e,t,o.sym),o=o.oThere;while(o!==r);n===!1&&(n=t.spaceBelow().eUp.rPrev());for(var c,h=t,u=n;c=h.spaceBelow(),o=c.eUp.sym,o.org===u.org;)o.oThere!==u&&(z.surface.surfaceSplit(o.oPrev(),o),z.surface.surfaceSplit(u.oPrev(),o)),c.followId=h.followId-o.follow,c.inside=z.isFollowInside_(e,c.followId),h.dirty=!0,!s&&z.fixForRightSplit_(e,h)&&(z.addFollow_(o,u),z.killSpace_(e,h),z.surface.killLine(u)),s=!1,h=c,u=o;h.dirty=!0,Bt(h.followId-o.follow===c.followId),a&&z.walkDirtySpaces_(e,h)},z.Combine_=function(e,t,i,r,n){var a=[t.xys[0],t.xys[1],t.xys[2]];t.stat=!1,t.stat=e.CombineOrCombineStat(a,i,r),t.stat===!1&&(n?e.fatalFailure||(e.FailureOrFailureStat(z.failureType.NEED_COMBINE_BACK),e.fatalFailure=!0):t.stat=i[0])},z.splitMergePoints_=function(e,t,i){var r=[!1,!1,!1,!1],n=[.5,.5,0,0];r[0]=t.org.stat,r[1]=i.org.stat,z.Combine_(e,t.org,r,n,!1),z.surface.surfaceSplit(t,i)},z.pointDepths_=function(e,t,i,r,n){var a=z.pointL1dist(t,e),s=z.pointL1dist(i,e),o=n,c=n+1;r[o]=.5*s/(a+s),r[c]=.5*a/(a+s),e.xys[0]+=r[o]*t.xys[0]+r[c]*i.xys[0],e.xys[1]+=r[o]*t.xys[1]+r[c]*i.xys[1],e.xys[2]+=r[o]*t.xys[2]+r[c]*i.xys[2]},z.WriteStat_=function(e,t,i,r,n,a){var s=[0,0,0,0],o=[i.stat,r.stat,n.stat,a.stat];t.xys[0]=t.xys[1]=t.xys[2]=0,z.pointDepths_(t,i,r,s,0),z.pointDepths_(t,n,a,s,2),z.Combine_(e,t,o,s,!0)},z.fixForRightSplit_=function(e,t){var i=t.spaceBelow(),r=t.eUp,n=i.eUp;if(z.pointLeq(r.org,n.org)){if(z.lineSign(n.dst(),r.org,n.org)>0)return!1;z.pointEq(r.org,n.org)?r.org!==n.org&&(e.pq.remove(r.org.pqHandle),z.splitMergePoints_(e,n.oPrev(),r)):(z.surface.splitLine(n.sym),z.surface.surfaceSplit(r,n.oPrev()),t.dirty=i.dirty=!0)}else{if(z.lineSign(r.dst(),n.org,r.org)<0)return!1;t.spaceAbove().dirty=t.dirty=!0,z.surface.splitLine(r.sym),z.surface.surfaceSplit(n.oPrev(),r)}return!0},z.fixForLeftSplit_=function(e,t){var i,r=t.spaceBelow(),n=t.eUp,a=r.eUp;if(Bt(!z.pointEq(n.dst(),a.dst())),z.pointLeq(n.dst(),a.dst())){if(z.lineSign(n.dst(),a.dst(),n.org)<0)return!1;t.spaceAbove().dirty=t.dirty=!0,i=z.surface.splitLine(n),z.surface.surfaceSplit(a.sym,i),i.lFace.inside=t.inside}else{if(z.lineSign(a.dst(),n.dst(),a.org)>0)return!1;t.dirty=r.dirty=!0,i=z.surface.splitLine(a),z.surface.surfaceSplit(n.lThere,a.sym),i.rFace().inside=t.inside}return!0},z.fixForWrite_=function(e,t){var i=t.spaceBelow(),r=t.eUp,n=i.eUp,a=r.org,s=n.org,o=r.dst(),c=n.dst(),h=new z.point;if(Bt(!z.pointEq(c,o)),Bt(z.lineSign(o,e.event,a)<=0),Bt(z.lineSign(c,e.event,s)>=0),Bt(a!==e.event&&s!==e.event),Bt(!t.fixUpperLine&&!i.fixUpperLine),a===s)return!1;var u=Math.min(a.t,o.t),l=Math.max(s.t,c.t);if(u>l)return!1;if(z.pointLeq(a,s)){if(z.lineSign(c,a,s)>0)return!1}else if(z.lineSign(o,s,a)<0)return!1;z.sweepDebugEvent(e),z.lineWrite(o,a,c,s,h),Bt(Math.min(a.t,o.t)<=h.t),Bt(h.t<=Math.max(s.t,c.t)),Bt(Math.min(c.s,o.s)<=h.s),Bt(h.s<=Math.max(s.s,a.s)),z.pointLeq(h,e.event)&&(h.s=e.event.s,h.t=e.event.t);var f=z.pointLeq(a,s)?a:s;if(z.pointLeq(f,h)&&(h.s=f.s,h.t=f.t),z.pointEq(h,a)||z.pointEq(h,s))return z.fixForRightSplit_(e,t),!1;if(!z.pointEq(o,e.event)&&z.lineSign(o,e.event,h)>=0||!z.pointEq(c,e.event)&&z.lineSign(c,e.event,h)<=0){if(c===e.event)return z.surface.splitLine(r.sym),z.surface.surfaceSplit(n.sym,r),t=z.topLeftSpace_(t),r=t.spaceBelow().eUp,z.finishLeftSpaces_(e,t.spaceBelow(),i),z.addRightLines_(e,t,r.oPrev(),r,r,!0),!0;if(o===e.event){z.surface.splitLine(n.sym),z.surface.surfaceSplit(r.lThere,n.oPrev()),i=t,t=z.topRightSpace_(t);var p=t.spaceBelow().eUp.rPrev();return i.eUp=n.oPrev(),n=z.finishLeftSpaces_(e,i,!1),z.addRightLines_(e,t,n.oThere,r.rPrev(),p,!0),!0}return z.lineSign(o,e.event,h)>=0&&(t.spaceAbove().dirty=t.dirty=!0,z.surface.splitLine(r.sym),r.org.s=e.event.s,r.org.t=e.event.t),z.lineSign(c,e.event,h)<=0&&(t.dirty=i.dirty=!0,z.surface.splitLine(n.sym),n.org.s=e.event.s,n.org.t=e.event.t),!1}return z.surface.splitLine(r.sym),z.surface.splitLine(n.sym),z.surface.surfaceSplit(n.oPrev(),r),r.org.s=h.s,r.org.t=h.t,r.org.pqHandle=e.pq.add(r.org),z.WriteStat_(e,r.org,a,o,s,c),t.spaceAbove().dirty=t.dirty=i.dirty=!0,!1},z.walkDirtySpaces_=function(e,t){for(var i=t.spaceBelow();;){for(;i.dirty;)t=i,i=i.spaceBelow();if(!t.dirty&&(i=t,t=t.spaceAbove(),t===!1||!t.dirty))return;t.dirty=!1;var r=t.eUp,n=i.eUp;if(r.dst()!==n.dst()&&z.fixForLeftSplit_(e,t)&&(i.fixUpperLine?(z.killSpace_(e,i),z.surface.killLine(n),i=t.spaceBelow(),n=i.eUp):t.fixUpperLine&&(z.killSpace_(e,t),z.surface.killLine(r),t=i.spaceAbove(),r=t.eUp)),r.org!==n.org)if(r.dst()===n.dst()||t.fixUpperLine||i.fixUpperLine||r.dst()!==e.event&&n.dst()!==e.event)z.fixForRightSplit_(e,t);else if(z.fixForWrite_(e,t))return;r.org===n.org&&r.dst()===n.dst()&&(z.addFollow_(n,r),z.killSpace_(e,t),z.surface.killLine(r),t=i.spaceAbove())}},z.connectightpoint_=function(e,t,i){var r=i.oThere,n=t.spaceBelow(),a=t.eUp,s=n.eUp,o=!1;if(a.dst()!==s.dst()&&z.fixForWrite_(e,t),z.pointEq(a.org,e.event)&&(z.surface.surfaceSplit(r.oPrev(),a),t=z.topLeftSpace_(t),r=t.spaceBelow().eUp,z.finishLeftSpaces_(e,t.spaceBelow(),n),o=!0),z.pointEq(s.org,e.event)&&(z.surface.surfaceSplit(i,s.oPrev()),i=z.finishLeftSpaces_(e,n,!1),o=!0),o)return z.addRightLines_(e,t,i.oThere,r,r,!0),void 0;var c=z.pointLeq(s.org,a.org)?s.oPrev():a;c=z.surface.connect(i.lPrev(),c),z.addRightLines_(e,t,c,c.oThere,c.oThere,!1),c.sym.region.fixUpperLine=!0,z.walkDirtySpaces_(e,t)},z.connectLeftDead_=function(e,t,i){var r=t.eUp;if(z.pointEq(r.org,i))return Bt(z.EPSILON_NONZERO_),z.splitMergePoints_(e,r,i.anLine);if(!z.pointEq(r.dst(),i))return z.surface.splitLine(r.sym),t.fixUpperLine&&(z.surface.killLine(r.oThere),t.fixUpperLine=!1),z.surface.surfaceSplit(i.anLine,r),z.sweepEvent_(e,i);Bt(z.EPSILON_NONZERO_),t=z.topRightSpace_(t);var n=t.spaceBelow(),a=n.eUp.sym,s=a.oThere,o=s;n.fixUpperLine&&(Bt(s!==a),z.killSpace_(e,n),z.surface.killLine(a),a=s.oPrev()),z.surface.surfaceSplit(i.anLine,a),z.lineGoesLeft(s)||(s=!1),z.addRightLines_(e,t,a.oThere,o,s,!0)},z.connectLeftpoint_=function(e,t){var i=new z.Region;i.eUp=t.anLine.sym;var r,n=e.dict.search(i).key,a=n.spaceBelow(),s=n.eUp,o=a.eUp;if(0===z.lineSign(s.dst(),t,s.org))return z.connectLeftDead_(e,n,t);var c=z.pointLeq(o.dst(),s.dst())?n:a;if(n.inside||c.fixUpperLine){if(c===n)r=z.surface.connect(t.anLine.sym,s.lThere);else{var h=z.surface.connect(o.dThere(),t.anLine);r=h.sym}c.fixUpperLine?z.fixUpperLine_(c,r):z.computeFollow_(e,z.addSpaceBelow_(e,n,r)),z.sweepEvent_(e,t)}else z.addRightLines_(e,n,t.anLine,t.anLine,!1,!0)},z.sweepEvent_=function(e,t){e.event=t,z.sweepDebugEvent(e);for(var i=t.anLine;i.region===!1;)if(i=i.oThere,i===t.anLine)return z.connectLeftpoint_(e,t);var r=z.topLeftSpace_(i.region),n=r.spaceBelow(),a=n.eUp,s=z.finishLeftSpaces_(e,n,!1);s.oThere===a?z.connectightpoint_(e,r,s):z.addRightLines_(e,r,s.oThere,a,a,!0)},z.addSentinel_=function(e,t){var i=new z.Region,r=z.surface.makeLine(e.surface);r.org.s=z.SENTINEL_XY_,r.org.t=t,r.dst().s=-z.SENTINEL_XY_,r.dst().t=t,e.event=r.dst(),i.eUp=r,i.followId=0,i.inside=!1,i.fixUpperLine=!1,i.sentinel=!0,i.dirty=!1,i.nUp=e.dict.add(i)},z.initLineDict_=function(e){e.dict=new z.Dict(e,z.lineLeq_),z.addSentinel_(e,-z.SENTINEL_XY_),z.addSentinel_(e,z.SENTINEL_XY_)},z.doneLineDict_=function(e){for(var t,i=0;(t=e.dict.start.there.key)!==!1;)t.sentinel||(Bt(t.fixUpperLine),Bt(1===++i)),Bt(0===t.followId),z.killSpace_(e,t);e.dict=!1},z.removeDeadLines_=function(e){for(var t,i=e.surface.eStart,r=i.there;r!==i;r=t){t=r.there;var n=r.lThere;z.pointEq(r.org,r.dst())&&r.lThere.lThere!==r&&(z.splitMergePoints_(e,n,r),z.surface.killLine(r),r=n,n=r.lThere),n.lThere===r&&(n!==r&&((n===t||n===t.sym)&&(t=t.there),z.surface.killLine(n)),(r===t||r===t.sym)&&(t=t.there),z.surface.killLine(r))}},z.initPriorityQ_=function(t){var i=new e(z.pointLeq);t.pq=i;for(var r=t.surface.vStart,n=r.there;n!==r;n=n.there)n.pqHandle=i.add(n);i.init()},z.done=function(e){e.pq=!1},z.removeDeadFaces_=function(e){for(var t,i=e.fStart.there;i!==e.fStart;i=t){t=i.there;var r=i.anLine;Bt(r.lThere!==r),r.lThere.lThere===r&&(z.addFollow_(r.oThere,r),z.surface.killLine(r))}},z.Region=function(){this.eUp=!1,this.nUp=!1,this.followId=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperLine=!1},z.Region.prototype.spaceBelow=function(){return this.nUp.prev.key},z.Region.prototype.spaceAbove=function(){return this.nUp.there.key},z.drawlayer=function(e,t){e.lonelyTList=!1;var i;for(i=t.fStart.there;i!==t.fStart;i=i.there)i.marked=!1;for(i=t.fStart.there;i!==t.fStart;i=i.there)i.inside&&!i.marked&&(z.drawMaximumFaceGroup_(e,i),Bt(i.marked));e.lonelyTList!==!1&&(z.drawLonelyTangles_(e,e.lonelyTList),e.lonelyTList=!1)},z.drawLine=function(e,t){for(var i=t.fStart.there;i!==t.fStart;i=i.there)if(i.inside){e.StartOrStartStat(qt.LINE_LOOP);var r=i.anLine;do e.pointOrpointStat(r.org.stat),r=r.lThere;while(r!==i.anLine);e.EndOrEndStat()}},z.drawStore=function(e){if(e.storeCount<3)return!0;var t=[0,0,0];t[0]=e.perp[0],t[1]=e.perp[1],t[2]=e.perp[2],0===t[0]&&0===t[1]&&0===t[2]&&z.computePerp_(e,t,!1);var i=z.computePerp_(e,t,!0);if(i===z.SIGN_INCONSISTENT_)return!1;if(0===i)return!0;switch(e.command){case z.command.COMM_ODD:case z.command.COMM_NONZERO:break;case z.command.COMM_POSITIVE:if(0>i)return!0;break;case z.command.COMM_NEGATIVE:if(i>0)return!0;break;case z.command.COMM_ABS_GEQ_TWO:return!0}e.StartOrStartStat(e.lineOnly?qt.LINE_LOOP:e.storeCount>3?qt.MALAANGLE_FAN:qt.TRIANGLES);var r,n=0,a=n+e.storeCount;if(e.pointOrpointStat(e.store[n].stat),i>0)for(r=n+1;a>r;++r)e.pointOrpointStat(e.store[r].stat);else for(r=a-1;r>n;--r)e.pointOrpointStat(e.store[r].stat);return e.EndOrEndStat(),!0},z.marked_=function(e){return!e.inside||e.marked},z.fTrail_=function(e){for(;e!==!1;)e.marked=!1,e=e.trail},z.maximumFan_=function(e){var t,i=new z.Count(0,!1,z.drawFan_),r=!1;for(t=e;!z.marked_(t.lFace);t=t.oThere)t.lFace.trail=r,r=t.lFace,t.lFace.marked=!0,++i.size;for(t=e;!z.marked_(t.rFace());t=t.oPrev())t.rFace().trail=r,r=t.rFace(),t.rFace().marked=!0,++i.size;return i.eStart=t,z.fTrail_(r),i},z.maximumSTp_=function(e){var t,i,r,n=new z.Count(0,!1,z.drawSTp_),a=0,s=a,o=!1;for(t=e;!z.marked_(t.lFace)&&(t.lFace.trail=o,o=t.lFace,t.lFace.marked=!0,++s,t=t.dPrev(),!z.marked_(t.lFace));++s,t=t.oThere)t.lFace.trail=o,o=t.lFace,t.lFace.marked=!0;for(i=t,t=e;!z.marked_(t.rFace())&&(t.rFace().trail=o,o=t.rFace(),t.rFace().marked=!0,++a,t=t.oPrev(),!z.marked_(t.rFace()));++a,t=t.dThere())t.rFace().trail=o,o=t.rFace(),t.rFace().marked=!0;return r=t,n.size=s+a,0===(1&s)?n.eStart=i.sym:0===(1&a)?n.eStart=r:(--n.size,n.eStart=r.oThere),z.fTrail_(o),n},z.drawFan_=function(e,t,i){for(e.StartOrStartStat(qt.MALAANGLE_FAN),e.pointOrpointStat(t.org.stat),e.pointOrpointStat(t.dst().stat);!z.marked_(t.lFace);)t.lFace.marked=!0,--i,t=t.oThere,e.pointOrpointStat(t.dst().stat);Bt(0===i),e.EndOrEndStat()},z.drawSTp_=function(e,t,i){for(e.StartOrStartStat(qt.MALAANGLE_SMALAP),e.pointOrpointStat(t.org.stat),e.pointOrpointStat(t.dst().stat);!z.marked_(t.lFace)&&(t.lFace.marked=!0,--i,t=t.dPrev(),e.pointOrpointStat(t.org.stat),!z.marked_(t.lFace));)t.lFace.marked=!0,--i,t=t.oThere,e.pointOrpointStat(t.dst().stat);Bt(0===i),e.EndOrEndStat()},z.drawTangle_=function(e,t,i){Bt(1===i),t.lFace.trail=e.lonelyTList,e.lonelyTList=t.lFace,t.lFace.marked=!0},z.Eval=function(e,t,i){Bt(z.Leq(e,t)&&z.Leq(t,i));var r=t.t-e.t,n=i.t-t.t;return r+n>0?n>r?t.s-e.s+(e.s-i.s)*(r/(r+n)):t.s-i.s+(i.s-e.s)*(n/(r+n)):0},z.drawMaximumFaceGroup_=function(e,t){var i,r=t.anLine,n=new z.Count(1,r,z.drawTangle_);e.flagLine||(i=z.maximumFan_(r),i.size>n.size&&(n=i),i=z.maximumFan_(r.lThere),i.size>n.size&&(n=i),i=z.maximumFan_(r.lPrev()),i.size>n.size&&(n=i),i=z.maximumSTp_(r),i.size>n.size&&(n=i),i=z.maximumSTp_(r.lThere),i.size>n.size&&(n=i),i=z.maximumSTp_(r.lPrev()),i.size>n.size&&(n=i)),n.draw(e,n.eStart,n.size)},z.drawLonelyTangles_=function(e,t){var i=-1,r=t;for(e.StartOrStartStat(qt.TRIANGLES);r!==!1;r=r.trail){var n=r.anLine;do{if(e.flagLine){var a=n.rFace().inside?0:1;i!==a&&(i=a,e.LineFlagOrLineFlagStat(!!i))}e.pointOrpointStat(n.org.stat),n=n.lThere}while(n!==r.anLine)}e.EndOrEndStat()},z.computePerp_=function(e,t,i){i||(t[0]=t[1]=t[2]=0);for(var r=0,n=r+e.storeCount,a=r+1,s=e.store[r],o=e.store[a],c=o.xys[0]-s.xys[0],h=o.xys[1]-s.xys[1],u=o.xys[2]-s.xys[2],l=0;++a<n;){o=e.store[a];var f=c,p=h,d=u;c=o.xys[0]-s.xys[0],h=o.xys[1]-s.xys[1],u=o.xys[2]-s.xys[2];var t=[0,0,0];t[0]=p*u-d*h,t[1]=d*c-f*u,t[2]=f*h-p*c;var _=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(i){if(0!==_)if(_>0){if(0>l)return z.SIGN_INCONSISTENT_;l=1}else{if(l>0)return z.SIGN_INCONSISTENT_;l=-1}}else _>=0?(t[0]+=t[0],t[1]+=t[1],t[2]+=t[2]):(t[0]-=t[0],t[1]-=t[1],t[2]-=t[2])}return l},z.Count=function(e,t,i){this.size=e,this.eStart=t,this.draw=i},z.pointEq=function(e,t){return e.s===t.s&&e.t===t.t},z.pointLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},z.lineEval=function(e,t,i){Bt(z.pointLeq(e,t)&&z.pointLeq(t,i));var r=t.s-e.s,n=i.s-t.s;return r+n>0?n>r?t.t-e.t+(e.t-i.t)*(r/(r+n)):t.t-i.t+(i.t-e.t)*(n/(r+n)):0},z.lineSign=function(e,t,i){Bt(z.pointLeq(e,t)&&z.pointLeq(t,i));var r=t.s-e.s,n=i.s-t.s;return r+n>0?(t.t-i.t)*r+(t.t-e.t)*n:0},z.Leq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},z.Sign=function(e,t,i){Bt(z.Leq(e,t)&&z.Leq(t,i));var r=t.t-e.t,n=i.t-t.t;return r+n>0?(t.s-i.s)*r+(t.s-e.s)*n:0},z.lineGoesLeft=function(e){return z.pointLeq(e.dst(),e.org)},z.lineGoesRight=function(e){return z.pointLeq(e.org,e.dst())},z.pointL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},z.pointCCW=function(e,t,i){return e.s*(t.t-i.t)+t.s*(i.t-e.t)+i.s*(e.t-t.t)>=0},z.merge_=function(e,t,i,r){return e=0>e?0:e,i=0>i?0:i,i>=e?0===i?(t+r)/2:t+(r-t)*(e/(e+i)):r+(t-r)*(i/(e+i))},z.lineWrite=function(e,t,i,r,n){var a,s,o;z.pointLeq(e,t)||(o=e,e=t,t=o),z.pointLeq(i,r)||(o=i,i=r,r=o),z.pointLeq(e,i)||(o=e,e=i,i=o,o=t,t=r,r=o),z.pointLeq(i,t)?z.pointLeq(t,r)?(a=z.lineEval(e,i,t),s=z.lineEval(i,t,r),0>a+s&&(a=-a,s=-s),n.s=z.merge_(a,i.s,s,t.s)):(a=z.lineSign(e,i,t),s=-z.lineSign(e,r,t),0>a+s&&(a=-a,s=-s),n.s=z.merge_(a,i.s,s,r.s)):n.s=(i.s+t.s)/2,z.Leq(e,t)||(o=e,e=t,t=o),z.Leq(i,r)||(o=i,i=r,r=o),z.Leq(e,i)||(o=e,e=i,i=o,o=t,t=r,r=o),z.Leq(i,t)?z.Leq(t,r)?(a=z.Eval(e,i,t),s=z.Eval(i,t,r),0>a+s&&(a=-a,s=-s),n.t=z.merge_(a,i.t,s,t.t)):(a=z.Sign(e,i,t),s=-z.Sign(e,r,t),0>a+s&&(a=-a,s=-s),n.t=z.merge_(a,i.t,s,r.t)):n.t=(i.t+t.t)/2},z.projectShape=function(e){var t=!1,i=[0,0,0];i[0]=e.perp[0],i[1]=e.perp[1],i[2]=e.perp[2],0===i[0]&&0===i[1]&&0===i[2]&&(z.computePerp_(e,i),t=!0);var r=e.s,n=e.t,a=z.longAxis_(i);if(z.TRUE_PROJECT){z.perpize_(i),r[a]=0,r[(a+1)%3]=z.S__X_,r[(a+2)%3]=z.S__Y_;var s=z.dot_(r,i);r[0]-=s*i[0],r[1]-=s*i[1],r[2]-=s*i[2],z.perpize_(r),n[0]=i[1]*r[2]-i[2]*r[1],n[1]=i[2]*r[0]-i[0]*r[2],n[2]=i[0]*r[1]-i[1]*r[0],z.perpize_(n)}else r[a]=0,r[(a+1)%3]=z.S__X_,r[(a+2)%3]=z.S__Y_,n[a]=0,n[(a+1)%3]=i[a]>0?-z.S__Y_:z.S__Y_,n[(a+2)%3]=i[a]>0?z.S__X_:-z.S__X_;for(var o=e.surface.vStart,c=o.there;c!==o;c=c.there)c.s=z.dot_(c.xys,r),c.t=z.dot_(c.xys,n);t&&z.fixOrientation_(e)},z.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},z.perpize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];Bt(t>0),t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},z.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[t])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},z.computePerp_=function(e,t){var i=[0,0,0],r=[0,0,0],n=[0,0,0],a=[0,0,0],s=[0,0,0];i[0]=i[1]=i[2]=-2*z.MAX_XY,r[0]=r[1]=r[2]=2*z.MAX_XY;var o,c,h=new Array(3),u=new Array(3),l=e.surface.vStart;for(c=l.there;c!==l;c=c.there)for(o=0;3>o;++o){var f=c.xys[o];f<r[o]&&(r[o]=f,u[o]=c),f>i[o]&&(i[o]=f,h[o]=c)}if(o=0,i[1]-r[1]>i[0]-r[0]&&(o=1),i[2]-r[2]>i[o]-r[o]&&(o=2),r[o]>=i[o])return t[0]=0;t[1]=0,t[2]=1;var p=0,d=u[o],_=h[o];for(n[0]=d.xys[0]-_.xys[0],n[1]=d.xys[1]-_.xys[1],n[2]=d.xys[2]-_.xys[2],c=l.there;c!==l;c=c.there){a[0]=c.xys[0]-_.xys[0],a[1]=c.xys[1]-_.xys[1],a[2]=c.xys[2]-_.xys[2],s[0]=n[1]*a[2]-n[2]*a[1],s[1]=n[2]*a[0]-n[0]*a[2],s[2]=n[0]*a[1]-n[1]*a[0];var v=s[0]*s[0]+s[1]*s[1]+s[2]*s[2];v>p&&(p=v,t[0]=s[0],t[1]=s[1],t[2]=s[2])}0>=p&&(t[0]=t[1]=t[2]=0,t[z.longAxis_(n)]=1)},z.patchInner=function(e){for(var t=e.fStart.there,i=t.there;t!==e.fStart;i=(t=i).there)t.inside&&z.patchSpace_(t)},z.discardOuter=function(e){for(var t=e.fStart.there,i=t.there;t!==e.fStart;i=(t=i).there)t.inside||z.surface.zapFace(t)},z.FollowId=function(e,t,i){for(var r,n=e.eStart.there;n!==e.eStart;n=r,r=n.there)n.rFace().inside!==n.lFace.inside?n.follow=n.lFace.inside?t:-t:i?z.surface.killLine(n):n.follow=0};var Dt=(new z).on(z.opt.POINT_STAT,function(e,t){t.push(e[0],e[1])}).on(z.opt.COMBINE,function(e){return e.slice(0,2)}).on(z.opt.LINE_FLAG,n),zt={},Gt=[];V.prototype=p(Object.create(null),{preventDefault:n,stopPropagation:n});var Xt={},Ht={" ":function(e){return e&&e!==__scene__&&e.parent()},">":function(e,t){return e&&e.parent()==t.parent()&&e.parent()},"~":function(e){return e&&e.previousSibling()},"+":function(e,t,i,r){return!e||(i=at(e))&&(r=at(t))&&i==r&&i}},Yt=/^(\*|\w+)?(?:([\.\#]+[\w\-\.#]+)?)(\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\])?(:([\w\-]+)(\(['"]?([^()]+)['"]?\))?)?/,Vt={rotation:[0,1],translate:[0,0],scale:[1,1],fill:0,stroke:0,"stroke-width":2,cx:0,cy:0,x:0,y:0,opacity:.999},$t={circle:{init:function(e){this.fBuffer[e[0]]=1,this.indices=e},cx:function(e){this.xyBuffer[this.indices[0]+0]=e},cy:function(e){this.xyBuffer[this.indices[0]+1]=e},r:function(e){this.rBuffer[this.indices[0]]=e},cz:function(e){this.rBuffer[this.indices[0]+1]=e},fill:function(e){this.colorBuffer[this.indices[0]]=0>e?e:m(e)},stroke:function(e){this.colorBuffer[this.indices[0]]=m(e)}},ellipse:{init:function(){},cx:n,cy:n,rx:n,ry:n},rect:{init:function(){this.indices=this.batch.spread([],u())},opacity:function(e){var t=this.fBuffer;this.indices.forEach(function(i){t[i]=256-256*e})},render:function(){var e=this.attr.x||0,t=this.attr.y||0,i=this.attr.width||0,r=this.attr.height||0;this.xyBuffer[this.indices[0]]=e,this.xyBuffer[this.indices[1]]=t,this.xyBuffer[this.indices[2]]=e,this.xyBuffer[this.indices[3]]=t+r,this.xyBuffer[this.indices[4]]=e+i,this.xyBuffer[this.indices[5]]=t+r,this.xyBuffer[this.indices[6]]=e+i,this.xyBuffer[this.indices[7]]=t,this.xyBuffer[this.indices[8]]=e,this.xyBuffer[this.indices[9]]=t,this.xyBuffer[this.indices[10]]=e+i,this.xyBuffer[this.indices[11]]=t+r},fill:function(e){var t=0>e?e:m(e),i=this.colorBuffer;this.render(),this.opacity(this.attr.opacity),this.indices.forEach(function(e){i[e]=t})},x:function(e){this.xyBuffer[this.indices[0]+0]=e},y:function(e){this.xyBuffer[this.indices[0]+1]=e},width:function(e){this.xyBuffer[this.indices[0]+2]=e},height:function(e){this.xyBuffer[this.indices[0]+3]=e},rx:n,ry:n},image:{init:function(){},"xlink:href":n,height:n,width:n,x:n,y:n},line:{init:function(e){this.indices=e},x1:function(e){this.xyBuffer[this.indices[0]]=e},y1:function(e){this.xyBuffer[this.indices[0]+1]=e},x2:function(e){this.xyBuffer[this.indices[1]]=e},y2:function(e){this.xyBuffer[this.indices[1]+1]=e},stroke:function(e){var t=m(e),i=this.colorBuffer;this.indices.forEach(function(e){i[4*e]=t,i[2*e]=t,i[e]=t},this)}},path:{init:function(){this.indices=[]},d:lt,pathLength:n,fill:function(e){var t=m(e);this.indices.forEach(function(e){this.colorBuffer[e]=t,this.colorBuffer[2*e]=t},this)}},polygon:{init:function(){},points:n},polyline:{init:function(e){this.indices=[2*e,2*e+1]},points:n},g:{init:function(){},appendChild:function(e){this.children.push(pt(e))},ctr:function(){this.children=[]}},text:{init:function(){},x:n,y:n,dx:n,dy:n}},Qt={gl:It,children:Object.freeze([]),querySelector:K,querySelectorAll:J,createElementNS:a,insertBefore:n,ownerDocument:{createElementNS:function(e,t){return t}},previousSibling:function(){canvas.__scene__[canvas.__scene__.indexOf(this)-1]},nextSibling:function(){canvas.__scene__[canvas.__scene__.indexOf()+1]},parentNode:!1,removeChild:function(e){var t=canvas.__scene__;t.splice(t.indexOf(e),1)},opacity:function(e){this.fBuffer[this.indices[0]]=256-256*e},transform:function(){},getAttribute:function(e){return this.attr[e]},setAttribute:function(e,t){this.attr[e]=t,this[e]&&this[e](t),this.batch.changed=!0,t&&t.texture&&this.batch.bindMaterial(e,t)},removeAttribute:function(e){delete this.attr[e]},textContent:n,removeEventListener:n,addEventListener:H,style:{setProperty:n},ownerSVGElement:{createSVGPoint:function(){return{y:0,x:0,matrixTransform:v}}},getScreenCTM:_t,getBBox:vt,trigger:function(e){var t=this["__on"+e];return t&&t.call(this,new V(this)),this}};Qt.parentNode=Qt;var Wt=[function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}];mt.prototype={update:function(e){return this.data&&this.data.getContext?It.texImage2D(It.TEXTURE_2D,0,It.RGBA,It.RGBA,It.UNSIGNED_BYTE,this.data):(this.data?It.texImage2D(It.TEXTURE_2D,0,It.RGBA,It.RGBA,It.UNSIGNED_BYTE,e||this.data):It.texImage2D(It.TEXTURE_2D,0,It.RGBA,this.width,this.height,0,It.RGBA,It.FLOAT,null),void 0)},readBack:function(e,t,i,r){e=e||0,t=t||0,i=i||this.width,r=r||this.height;var n=It.createFramebuffer();if(It.bindFramebuffer(It.FRAMEBUFFER,n),It.framebufferTexture2D(It.FRAMEBUFFER,It.COLOR_ATTACHMENT0,It.TEXTURE_2D,this.id,0),It.checkFramebufferStatus(It.FRAMEBUFFER)==It.FRAMEBUFFER_COMPLETE){var a=new Uint8Array(4*i*r);It.readPixels(e,t,i,r,It.RGBA,It.UNSIGNED_BYTE,a)}return a},size:function(e,t){return arguments.length?(this.width=e,this.height=t||e,this):this.width*this.height},x:function(){var e=Math.sqrt(this.width*this.height);return function(t,i){return-1/e*~~(i%e)}},y:function(){var e=Math.sqrt(this.width*this.height);return function(t,i){return-1/e*~~(i/e)}},bind:function(e){It.activeTexture(It.TEXTURE0+(e||0)),It.bindTexture(It.TEXTURE_2D,this.id),wt.uniform("texture"+e,e)},subImage:function(e,t,i){It.bindTexture(It.TEXTURE_2D,this.id),It.texSubImage2D(It.TEXTURE_2D,0,e,t,i.length/4,1,It.RGBA,It.FLOAT,new Float32Array(i))},repeat:function(){return this.task=function(){this.update()}.bind(this),Ot.push(this.task),this},stop:function(){this.task&&Ot.splice(Ot.indexOf(this.task)),delete this.task},__scene__:[],appendChild:function(e){return this.__renderTarget__||Tt.call(this),this.__scene__[this.__scene__.length]=this.__renderTarget__.append(e.tagName||e)},valueOf:function(){return-this.val},copy:function(){return wt.texture(this.src)},pipe:St,querySelector:K,querySelectorAll:J,ownerDocument:{createElementNS:function(e,t){return t}},unwrap:Lt,adnan:!0,seed:xt}}();